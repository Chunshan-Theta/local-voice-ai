# 本地語音 AI 解決方案 (Local Voice AI Solution)

這個專案在於整合聲音互動元件所形成之本地語音解決方案，提供完整的語音對話體驗。系統採用微服務架構，結合了語音識別、自然語言處理和語音合成技術，打造出可在本地環境運行的智能語音助手。

## 📋 專案概述

本專案整合多個聲音互動元件，包括：
- **語音識別服務** - 使用 OpenAI Whisper 模型進行語音轉文字
- **智能對話引擎** - 基於 Ollama LLaMA3 模型提供智能回應
- **Web 前端介面** - Next.js 應用程式提供瀏覽器語音互動
- **容器化部署** - 支援 Docker 和 Kubernetes 部署

## 🏗️ 系統架構

```
                          使用者語音互動流程
    ┌─────────────────────────────────────────────────────────────────┐
    │                                                                 │
    ▼                  ①錄製語音                                        │
┌─────────┐         ┌──────────────┐                                   │
│  使用者  │────────►│ Web Frontend │                                   │
│ (瀏覽器) │         │  (Next.js)   │                                   │
└─────────┘         └──────┬───────┘                                   │
    ▲                      │                                           │
    │                      │②上傳音訊檔案                               │
    │⑤播放回應              ▼                                           │
    │              ┌──────────────┐   ③語音轉文字   ┌─────────────────┐ │
    │              │   API Route  │──────────────►│ Whisper Service │ │
    │              │  (/api/*)    │◄──────────────│   (Flask API)   │ │
    │              └──────┬───────┘   ④回傳文字    └─────────────────┘ │
    │                     │                                           │
    │                     │⑤傳送文字                                   │
    │                     ▼                                           │
    │              ┌─────────────────┐                                 │
    │              │ Ollama Service  │                                 │
    │              │   (LLaMA3)      │                                 │
    │              └─────────────────┘                                 │
    │                     │                                           │
    └─────────────────────┘⑥回傳AI回應                                 │
                                                                      │

```
```

                        Kubernetes 叢集環境                           
    ┌─────────────────────────────────────────────────────────────────┘
    │
    │  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐
    │  │    Pod      │   │    Pod      │   │    Pod      │
    │  │ ┌─────────┐ │   │ ┌─────────┐ │   │ ┌─────────┐ │
    │  │ │Next.js  │ │   │ │ Whisper │ │   │ │ Ollama  │ │
    │  │ │   App   │ │   │ │ Service │ │   │ │ Service │ │
    │  │ └─────────┘ │   │ └─────────┘ │   │ └─────────┘ │
    │  └─────────────┘   └─────────────┘   └─────────────┘
    │        │                  │                  │
    │        └──────────────────┼──────────────────┘
    │                           │
    │  ┌─────────────────────────┼─────────────────────────┐
    │  │                 Service Network                  │
    │  │          (負載均衡 & 服務發現)                     │
    │  └─────────────────────────────────────────────────┘
    └─────────────────────────────────────────────────────
```

## 🚀 主要功能

- 🎤 **瀏覽器語音錄製** - 支援即時語音輸入和錄製
- 🔊 **高精度語音識別** - 使用 Whisper 模型進行語音轉文字
- 🤖 **智能對話生成** - 基於 oLLaMA 模型的自然語言處理
- 💬 **即時對話介面** - 流暢的用戶互動體驗
- 🐳 **容器化部署** - 支援 Docker 和 Kubernetes 環境
- 🔧 **可擴展架構** - 微服務設計便於維護和擴展

## 🛠️ 技術棧

### 前端
- **Next.js** - React 框架
- **TypeScript** - 型別安全
- **MediaRecorder API** - 瀏覽器音訊錄製

### 後端服務
- **Flask** - Whisper 語音識別服務
- **Ollama** - LLaMA3 對話模型服務
- **Python** - 後端邏輯處理

### 部署與營運
- **Docker** - 容器化技術
- **Kubernetes** - 容器編排
- **Google Kubernetes Engine (GKE)** - 雲端部署

## 🚀 快速開始

### Kubernetes 部署

在 Kubernetes 叢集上部署完整系統：

```bash
1. ./k8s_ops_script/gcp_deploy_init.sh
2. ./k8s_ops_script/gcp_deploy_build.sh
3. ./k8s_ops_script/gcp_deploy_deploy.sh
```

### 本地開發環境

1. **啟動 Whisper 服務**
```bash
cd whisper-service
pip install -r requirements.txt
python app.py
```

2. **啟動 Ollama 服務**
```bash
# 安裝並啟動 Ollama
ollama serve
ollama pull llama3
```

3. **啟動前端應用**
```bash
cd app
npm install
npm run dev
```

## 📁 專案結構

```
local-voice-ai/
├── app/                    # Next.js 前端應用
├── whisper-service/        # Whisper 語音識別服務
├── k8s/                   # Kubernetes 部署配置
├── k8s_ops_script/        # 營運腳本
└── README.md              # 專案說明文件
```

## 🔧 配置說明

### 環境變數
- `WHISPER_MODEL`: Whisper 模型版本 (tiny/base/small/medium/large)
- `OLLAMA_HOST`: Ollama 服務地址
- `PORT`: 服務埠號

### Kubernetes 資源
- **Deployments**: 應用服務部署
- **Services**: 服務暴露和負載均衡
- **ConfigMaps**: 配置管理
- **PersistentVolumes**: 資料持久化

## 🌟 特色優勢

1. **完全本地化** - 無需依賴外部 API，保障資料隱私
2. **高度整合** - 聲音互動元件無縫整合
3. **容器化部署** - 易於部署和擴展
4. **微服務架構** - 模組化設計，便於維護
5. **多環境支援** - 支援本地開發和生產部署

## 📝 授權

本專案採用 MIT 授權條款。

